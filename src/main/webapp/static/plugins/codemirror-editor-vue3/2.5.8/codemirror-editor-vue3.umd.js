(function(u,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue"),require("codemirror/lib/codemirror.css"),require("codemirror/addon/fold/foldgutter.css"),require("codemirror/addon/fold/foldcode.js"),require("codemirror/addon/fold/foldgutter.js"),require("codemirror/addon/fold/brace-fold.js"),require("codemirror/addon/selection/active-line.js"),require("codemirror"),require("codemirror/addon/merge/merge.css"),require("codemirror/addon/merge/merge.js"),require("diff-match-patch"),require("codemirror/addon/mode/simple.js")):typeof define=="function"&&define.amd?define(["exports","vue","codemirror/lib/codemirror.css","codemirror/addon/fold/foldgutter.css","codemirror/addon/fold/foldcode.js","codemirror/addon/fold/foldgutter.js","codemirror/addon/fold/brace-fold.js","codemirror/addon/selection/active-line.js","codemirror","codemirror/addon/merge/merge.css","codemirror/addon/merge/merge.js","diff-match-patch","codemirror/addon/mode/simple.js"],t):(u=typeof globalThis<"u"?globalThis:u||self,t(u.InstallCodemirro={},u.Vue,null,null,null,null,null,null,u.codemirror,null,null,u.DiffMatchPatch))})(this,function(u,t,he,ye,ke,we,_e,$e,x,Ce,be,F){"use strict";!window.CodeMirror&&(window.CodeMirror=x);const C=window.CodeMirror||x,R=t.defineComponent({name:"DefaultMode",props:{name:{type:String,default:`cm-textarea-${+new Date}`},value:{type:String,default:""},content:{type:String,default:""},options:{type:Object,default:()=>({})},cminstance:{type:Object,default:()=>null},placeholder:{type:String,default:""}},emits:{ready:e=>e,"update:cminstance":e=>e},setup(e,{emit:r}){const a=t.ref(),n=t.ref(null),o=()=>{n.value=t.markRaw(C.fromTextArea(a.value,e.options)),r("update:cminstance",n.value);const s=t.watch(()=>e.cminstance,c=>{var g;c&&((g=e.cminstance)==null||g.setValue(e.value||e.content)),r("ready",t.unref(n)),s==null||s()},{deep:!0})};return t.onMounted(()=>{o()}),{textarea:a,initialize:o}}}),S=(e,r)=>{const a=e.__vccOpts||e;for(const[n,o]of r)a[n]=o;return a},H=["name","placeholder"];function z(e,r,a,n,o,s){return t.openBlock(),t.createElementBlock("textarea",{ref:"textarea",name:e.$props.name,placeholder:e.$props.placeholder},null,8,H)}const O=S(R,[["render",z]]);window.diff_match_patch=F,window.DIFF_DELETE=-1,window.DIFF_INSERT=1,window.DIFF_EQUAL=0;const P=t.defineComponent({name:"MergeMode",props:{options:{type:Object,default:()=>({})},cminstance:{type:Object,default:()=>({})}},emits:["update:cminstance","ready"],setup(e,{emit:r}){const a=t.ref(),n=t.ref(),o=()=>{a.value=t.markRaw(C.MergeView(n.value,e.options)),r("update:cminstance",a.value),r("ready",a)};return t.onMounted(()=>{o()}),{mergeView:n,initialize:o}}}),U={ref:"mergeView"};function W(e,r,a,n,o,s){return t.openBlock(),t.createElementBlock("div",U,null,512)}const G=S(P,[["render",W]]);var L=(e=>(e.info="info",e.warning="warning",e.error="error",e))(L||{});function T(){const e=new Date,r=e.getHours()<10?`0${e.getHours()}`:e.getHours(),a=e.getMinutes()<10?`0${e.getMinutes()}`:e.getMinutes(),n=e.getSeconds()<10?`0${e.getSeconds()}`:e.getSeconds();return`${r}:${a}:${n}`}function J(e){return`#link#${JSON.stringify(e)}#link#`}function I(e){const r=/#link#(.+)#link#/g,a=[];let n;for(n=r.exec(e);n;){const o=document.createElement("a"),s=JSON.parse(n[1]),c=Object.entries(s);for(const[g,m]of c)o.setAttribute(g,m);o.className="editor_custom_link",o.innerHTML="logDownload",a.push({start:n.index,end:n.index+n[0].length,node:o}),n=r.exec(e)}return a}function K(e="",r="info"){return`#log<${r}>log#${e}#log<${r}>log#`}function B(e){const r=[];function a(){const n=/#log<(\w*)>log#((.|\r\n|\n)*?)#log<(\w*)>log#/g;let o;for(o=n.exec(e);o;){const c=o[0].replace(/\r\n/g,`
`).split(`
`),m=o[2].replace(/\r\n/g,`
`).split(`
`),f=document.createElement("span"),i=o[1];f.className=`c-editor--log__${i}`;let p=0;for(let l=0;l<c.length;l++){const h=c[l],w=m[l],_=f.cloneNode(!1);_.innerText=w,r.push({start:o.index+p,end:o.index+p+h.length,node:_}),p=p+h.length+1}o=n.exec(e)}}return a(),r}function Q(e,r){return`[${T()}] <${r}> ${e}`}function X(e,r,a){const o=new Array(Math.max(r||15,5)).join(a||"=");return`${o}${e}${o}`}const Y=t.defineComponent({name:"CodemirrorFclog",props:{value:{type:String,default:""},name:{type:String,default:`cm-textarea-${+new Date}`},options:{type:Object,default:()=>({})},cminstance:{type:Object,default:()=>({})},placeholder:{type:String,default:""}},emits:["update:cminstance","ready"],setup(e,{emit:r}){const a=t.ref(),n=t.ref(null),o=(c=e.cminstance)=>{c.getAllMarks().forEach(i=>i.clear());const m=c.getValue(),f=[].concat(I(m)).concat(B(m));for(let i=0;i<f.length;i++){const p=f[i];c.markText(c.posFromIndex(p.start),c.posFromIndex(p.end),{replacedWith:p.node})}},s=()=>{var c;n.value=t.markRaw(C.fromTextArea(a.value,e.options)),r("update:cminstance",t.unref(n)),(c=n.value)==null||c.on("change",o)};return t.watch(()=>e.cminstance,c=>{var g;c&&(o(e.cminstance),(g=e.cminstance)==null||g.setValue(e.value),r("ready",n))},{deep:!0,immediate:!0}),t.onMounted(()=>{s()}),{initialize:s,textarea:a}}}),Z=["name","placeholder"];function ee(e,r,a,n,o,s){return t.openBlock(),t.createElementBlock("textarea",{ref:"textarea",name:e.$props.name,placeholder:e.$props.placeholder},null,8,Z)}const te=S(Y,[["render",ee]]),D={"update:value":()=>!0,change:(e,r)=>({value:e,cm:r}),input:()=>!0,ready:e=>e},ne=["changes","scroll","beforeChange","cursorActivity","keyHandled","inputRead","electricInput","beforeSelectionChange","viewportChange","swapDoc","gutterClick","gutterContextMenu","focus","blur","refresh","optionChange","scrollCursorIntoView","update"],re={...D,...(()=>{const e={};return ne.forEach(r=>{e[r]=(...a)=>a}),e})()},j={mode:"text",theme:"default",lineNumbers:!0,smartIndent:!0,indentUnit:2,styleActiveLine:!0};function oe(e){Promise.resolve().then(()=>{const r=e.getScrollInfo();e.scrollTo(r.left,r.height)})}const ae=({props:e,cminstance:r,emit:a,internalInstance:n,content:o})=>{const s=t.computed(()=>{var m;return e.merge?(m=t.unref(r))==null?void 0:m.editor():t.unref(r)}),c=()=>{const m=[];return Object.keys(n==null?void 0:n.vnode.props).forEach(f=>{if(f.startsWith("on")){const i=f.replace(f[2],f[2].toLowerCase()).slice(2);!D[i]&&m.push(i)}}),m};return{listenerEvents:()=>{s.value.on("change",i=>{const p=i.getValue();p===o.value&&p!==""||(o.value=p,a("update:value",o.value||""),a("input",o.value||" "),Promise.resolve().then(()=>{a("change",o.value,i)}),e.keepCursorInEnd&&oe(i))});const m={};c().filter(i=>!m[i]&&(m[i]=!0)).forEach(i=>{s.value.on(i,(...p)=>{a(i,...p)})})}}};function se({props:e,cminstance:r,presetRef:a}){const n=t.ref("100%"),o=t.ref("100%"),s=t.computed(()=>{var l;return e.merge?(l=t.unref(r))==null?void 0:l.editor():t.unref(r)}),c=()=>{var l;(l=s.value)==null||l.refresh()},g=(l=e.width,h=e.height)=>{var M;let w="",_="";String(l).includes("%")?(_="100%",n.value=String(l)):(_=String(l).replace("px",""),n.value=`${_}px`),String(h).includes("%")?(w="100%",o.value=String(h)):(w=String(h).replace("px",""),o.value=`${w}px`),(M=s.value)==null||M.setSize(_,w)},m=()=>{var h;const l=(h=s.value)==null?void 0:h.getWrapperElement();l==null||l.remove()},f=()=>{var h,w,_;const l=(h=s.value)==null?void 0:h.getDoc().getHistory();(w=a.value)==null||w.initialize(),m(),(_=s.value)==null||_.getDoc().setHistory(l)},i=()=>{const l=document.querySelector(".CodeMirror-gutters");return(l==null?void 0:l.style.left.replace("px",""))!=="0"};return{reload:f,refresh:c,resize:g,destroy:m,containerWidth:n,containerHeight:o,reviseStyle:()=>{if(c(),!i())return;const l=setInterval(()=>{i()?c():clearInterval(l)},60),h=setTimeout(()=>{clearInterval(l),clearTimeout(h)},400)}}}const b=t.defineComponent({__name:"index",props:{value:{type:String,default:""},options:{type:Object,default:()=>j},globalOptions:{type:Object,default:()=>j},placeholder:{type:String,default:""},border:{type:Boolean,default:!1},width:{type:[String,Number],default:null},height:{type:[String,Number],default:null},originalStyle:{type:Boolean,default:!1},keepCursorInEnd:{type:Boolean,default:!1},merge:{type:Boolean,default:!1},name:{type:String,default:""},marker:{type:Function,default:()=>null},unseenLines:{type:Array,default:()=>[]}},emits:re,setup(e,{expose:r,emit:a}){var A,V,q;typeof Object.assign!="function"&&Object.defineProperty(Object,"assign",{value(d){if(d==null)throw new TypeError("Cannot convert undefined or null to object");const y=Object(d);for(let k=1;k<arguments.length;k++){const $=arguments[k];if($!=null)for(const v in $)Object.prototype.hasOwnProperty.call($,v)&&(y[v]=$[v])}return y},writable:!0,configurable:!0});const n=e,o=a,s=t.ref(null),c=t.ref(""),g=t.shallowRef(O),m=t.ref({foldGutter:!0,...j,...n.globalOptions,...n.options,gutters:[...new Set(["CodeMirror-linenumbers","CodeMirror-foldgutter",...((A=n.options)==null?void 0:A.gutters)||[]])]}),f=t.getCurrentInstance(),i=n.name||((q=(V=f==null?void 0:f.parent)==null?void 0:V.type)==null?void 0:q.name)||void 0,p=t.ref(null),l=t.computed(()=>{var d;return n.merge?(d=t.unref(s))==null?void 0:d.editor():t.unref(s)}),{refresh:h,resize:w,destroy:_,containerHeight:M,containerWidth:de,reviseStyle:ue}=se({props:n,cminstance:s,presetRef:p}),{listenerEvents:me}=ae({props:n,cminstance:s,emit:o,internalInstance:f,content:c}),N=()=>{n.unseenLines!==void 0&&n.marker!==void 0&&n.unseenLines.forEach(d=>{var k,$;const y=(k=s.value)==null?void 0:k.lineInfo(d);($=s.value)==null||$.setGutterMarker(d,"breakpoints",y!=null&&y.gutterMarkers?null:n.marker())})},fe=d=>{var k,$;const y=(k=s.value)==null?void 0:k.getValue();d!==y&&(($=s.value)==null||$.setValue(d),c.value=d,ue()),N()},pe=()=>{me(),N(),w(n.width,n.height),o("ready",s.value),t.watch([()=>n.width,()=>n.height],([d,y])=>{w(d,y)},{deep:!0})},ge=()=>{if(n.options.mode==="fclog"||n.options.mode==="log"){g.value=te;return}if(n.merge){g.value=G;return}g.value=O};return t.watch(()=>n.options,d=>{var y;for(const k in n.options)(y=l.value)==null||y.setOption(k,t.unref(d[k]))},{deep:!0}),t.watch(()=>n.value,d=>{fe(d)}),t.watch(()=>n.merge,ge,{immediate:!0}),t.onBeforeUnmount(()=>{_()}),r({cminstance:s,resize:w,refresh:h,destroy:_}),(d,y)=>(t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(["codemirror-container",{merge:d.$props.merge,bordered:d.$props.border||d.$props.merge&&!n.originalStyle,"original-style":n.originalStyle}]),style:t.normalizeStyle({height:t.unref(M),width:t.unref(de)})},[(t.openBlock(),t.createBlock(t.resolveDynamicComponent(g.value),t.mergeProps({ref_key:"presetRef",ref:p,cminstance:s.value,"onUpdate:cminstance":y[0]||(y[0]=k=>s.value=k),style:{height:"100%"}},{...d.$props,...d.$attrs,options:m.value,name:t.unref(i),content:c.value},{onReady:pe}),null,16,["cminstance"]))],6))}}),E=(e,r)=>(r&&r.options&&(b.props.globalOptions.default=()=>r.options),console.log("初始化 ",(r==null?void 0:r.componentName)||"Codemirror"),e.component((r==null?void 0:r.componentName)||"Codemirror",b),e),le=window.CodeMirror||C,ce=E,ie=E;u.CodeMirror=le,u.GlobalCmComponent=ce,u.InstallCodemirro=ie,u.VueCodemirror=b,u.createLinkMark=J,u.createLog=Q,u.createLogMark=K,u.createTitle=X,u.default=b,u.getLinkMarks=I,u.getLocalTime=T,u.getLogMark=B,u.install=E,u.logErrorType=L,Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
